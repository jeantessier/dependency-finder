@startuml

skin rose
skinparam style strictuml
skinparam backgroundColor transparent

participant DependencyExtractor
participant TransientClassfileLoader
participant Classfile
participant LoadListenerVisitorAdapter
participant CodeDependencyCollector
participant NodeFactory

activate DependencyExtractor

DependencyExtractor -> TransientClassfileLoader ++ : load(filenames)
TransientClassfileLoader -> VerboseListener ++ #yellow : beginSession(loadEvent)
deactivate VerboseListener
TransientClassfileLoader -> LoadListenerVisitorAdapter ++ : beginSession(loadEvent)
deactivate LoadListenerVisitorAdapter

TransientClassfileLoader -> TransientClassfileLoader ++ : load(filename)

TransientClassfileLoader -> VerboseListener ++ #yellow : beginGroup(loadEvent)
deactivate VerboseListener
TransientClassfileLoader -> LoadListenerVisitorAdapter ++ : beginGroup(loadEvent)
deactivate LoadListenerVisitorAdapter

TransientClassfileLoader -> VerboseListener ++ #yellow : beginFile(loadEvent)
deactivate VerboseListener
TransientClassfileLoader -> LoadListenerVisitorAdapter ++ : beginFile(loadEvent)
deactivate LoadListenerVisitorAdapter

TransientClassfileLoader -> TransientClassfileLoader ++ : load(filename, inputStream)

TransientClassfileLoader -> VerboseListener ++ #yellow : beginClassfile(loadEvent)
deactivate VerboseListener
TransientClassfileLoader -> LoadListenerVisitorAdapter ++ : beginClassfile(loadEvent)
deactivate LoadListenerVisitorAdapter

TransientClassfileLoader -> Classfile ** : new

TransientClassfileLoader -> VerboseListener ++ #yellow : endClassfile(loadEvent)
deactivate VerboseListener
TransientClassfileLoader -> LoadListenerVisitorAdapter ++ : endClassfile(loadEvent)
LoadListenerVisitorAdapter -> Classfile ++ : accept(visitor)
Classfile -> CodeDependencyCollector ++ : visitClassfile(classfile)

CodeDependencyCollector -> VerboseListener ++ #pink : beginClass(dependencyEvent)
deactivate VerboseListener

group traverse [all parts of the classfile]
    CodeDependencyCollector -> CodeDependencyCollector ++ : visit(...)

    loop all dependencies
        CodeDependencyCollector -> NodeFactory ++ : create(...)
        deactivate NodeFactory

        CodeDependencyCollector -> VerboseListener ++ #pink : dependency(dependencyEvent)
        deactivate VerboseListener
    end

    deactivate CodeDependencyCollector
end

CodeDependencyCollector -> VerboseListener ++ #pink : endClass(dependencyEvent)
deactivate VerboseListener

deactivate CodeDependencyCollector
deactivate Classfile
deactivate LoadListenerVisitorAdapter

deactivate TransientClassfileLoader

TransientClassfileLoader -> VerboseListener ++ #yellow : endFile(loadEvent)
deactivate VerboseListener
TransientClassfileLoader -> LoadListenerVisitorAdapter ++ : endFile(loadEvent)
deactivate LoadListenerVisitorAdapter

TransientClassfileLoader -> VerboseListener ++ #yellow : endGroup(loadEvent)
deactivate VerboseListener
TransientClassfileLoader -> LoadListenerVisitorAdapter ++ : endGroup(loadEvent)
deactivate LoadListenerVisitorAdapter

deactivate TransientClassfileLoader

TransientClassfileLoader -> VerboseListener ++ #yellow : endSession(loadEvent)
deactivate VerboseListener
TransientClassfileLoader -> LoadListenerVisitorAdapter ++ : endSession(loadEvent)
deactivate LoadListenerVisitorAdapter


@enduml
